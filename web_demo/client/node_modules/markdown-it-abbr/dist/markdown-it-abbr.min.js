/*! markdown-it-abbr 2.0.0 https://github.com/markdown-it/markdown-it-abbr @license MIT */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).markdownitAbbr=n()}(this,(function(){"use strict";return function(e){const n=e.utils.escapeRE,t=e.utils.arrayReplaceAt,r=" \r\n$+<=>^`|~",i=e.utils.lib.ucmicro.P.source,o=e.utils.lib.ucmicro.Z.source;e.block.ruler.before("reference","abbr_def",(function(e,n,t,r){let i,o=e.bMarks[n]+e.tShift[n];const s=e.eMarks[n];if(o+2>=s)return!1;if(42!==e.src.charCodeAt(o++))return!1;if(91!==e.src.charCodeAt(o++))return!1;const c=o;for(;o<s;o++){const n=e.src.charCodeAt(o);if(91===n)return!1;if(93===n){i=o;break}92===n&&o++}if(i<0||58!==e.src.charCodeAt(i+1))return!1;if(r)return!0;const l=e.src.slice(c,i).replace(/\\(.)/g,"$1"),a=e.src.slice(i+2,s).trim();return 0!==l.length&&(0!==a.length&&(e.env.abbreviations||(e.env.abbreviations={}),void 0===e.env.abbreviations[":"+l]&&(e.env.abbreviations[":"+l]=a),e.line=n+1,!0))}),{alt:["paragraph","reference"]}),e.core.ruler.after("linkify","abbr_replace",(function(e){const s=e.tokens;if(!e.env.abbreviations)return;const c=new RegExp("(?:"+Object.keys(e.env.abbreviations).map((function(e){return e.substr(1)})).sort((function(e,n){return n.length-e.length})).map(n).join("|")+")"),l="(^|"+i+"|"+o+"|["+r.split("").map(n).join("")+"])("+Object.keys(e.env.abbreviations).map((function(e){return e.substr(1)})).sort((function(e,n){return n.length-e.length})).map(n).join("|")+")($|"+i+"|"+o+"|["+r.split("").map(n).join("")+"])",a=new RegExp(l,"g");for(let n=0,r=s.length;n<r;n++){if("inline"!==s[n].type)continue;let r=s[n].children;for(let i=r.length-1;i>=0;i--){const o=r[i];if("text"!==o.type)continue;let l=0;const u=o.content;a.lastIndex=0;const f=[];if(!c.test(u))continue;let b;for(;b=a.exec(u);){if(b.index>0||b[1].length>0){const n=new e.Token("text","",0);n.content=u.slice(l,b.index+b[1].length),f.push(n)}const n=new e.Token("abbr_open","abbr",1);n.attrs=[["title",e.env.abbreviations[":"+b[2]]]],f.push(n);const t=new e.Token("text","",0);t.content=b[2],f.push(t);const r=new e.Token("abbr_close","abbr",-1);f.push(r),a.lastIndex-=b[3].length,l=a.lastIndex}if(f.length){if(l<u.length){const n=new e.Token("text","",0);n.content=u.slice(l),f.push(n)}s[n].children=r=t(r,i,f)}}}}))}}));
